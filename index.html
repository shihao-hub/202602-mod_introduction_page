<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <meta name="description" content="饥荒联机版《更多物品》官方介绍页，最新最全的内容都在这里~" />
  <meta name="keywords" content="更多物品,更多物品介绍页,饥荒联机版更多物品" />
  <title>更多物品介绍页 test</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-dark: #1a1a1a;
      --bg-card: #2a2a2a;
      --bg-card-hover: #353535;
      --border-color: #4a4a4a;
      --text-primary: #e8e8e8;
      --text-secondary: #b8b8b8;
      --text-muted: #888;
      --accent-gold: #c9a227;
      --accent-gold-light: #e8c547;
      --accent-green: #4a9c6d;
      --accent-blue: #4a7c9c;
      --accent-red: #9c4a4a;
      --accent-purple: #7c4a9c;
      --shadow-color: rgba(0,0,0,0.5);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans SC', sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.6;
    }

    /* 背景纹理 */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image: 
        radial-gradient(circle at 20% 30%, rgba(201, 162, 39, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(74, 156, 109, 0.03) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    /* 顶部标题区 */
    #toptitle {
      position: relative;
      z-index: 10;
      background: linear-gradient(180deg, #252525 0%, #1a1a1a 100%);
      border-bottom: 2px solid var(--accent-gold);
      padding: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.4);
    }

    .page_title {
      display: block;
      text-align: center;
      font-size: 28px;
      font-weight: 700;
      color: var(--accent-gold-light);
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
      margin-bottom: 16px;
      letter-spacing: 4px;
    }

    /* 搜索框 */
    #searchbox_waikuang {
      max-width: 400px;
      margin: 0 auto 16px;
      position: relative;
    }

    #searchbox {
      width: 100%;
      padding: 10px 16px 10px 40px;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      color: var(--text-primary);
      font-size: 14px;
      outline: none;
      transition: all 0.3s ease;
    }

    #searchbox:focus {
      border-color: var(--accent-gold);
      box-shadow: 0 0 0 2px rgba(201, 162, 39, 0.2);
    }

    #searchbox::placeholder {
      color: var(--text-muted);
    }

    #searchbox_waikuang::before {
      content: '⌕';
      position: absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted);
      font-size: 16px;
    }

    /* 导航按钮 */
    .navigation_box {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 16px;
    }

    .navigation_button {
      padding: 8px 16px;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      color: var(--text-secondary);
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease;
      user-select: none;
    }

    .navigation_button:hover {
      background: var(--bg-card-hover);
      border-color: var(--accent-gold);
      color: var(--text-primary);
    }

    .navigation_button.xuanzhong {
      background: linear-gradient(180deg, var(--accent-gold) 0%, #a88520 100%);
      border-color: var(--accent-gold-light);
      color: #1a1a1a;
      font-weight: 500;
    }

    /* 筛选区 */
    .screen_box {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
    }

    .screen_title {
      font-size: 13px;
      color: var(--text-muted);
    }

    .screen_button {
      padding: 6px 12px;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      color: var(--text-secondary);
      font-size: 13px;
      cursor: pointer;
      outline: none;
      min-width: 80px;
      transition: all 0.2s ease;
    }

    .screen_button:hover,
    .screen_button:focus {
      border-color: var(--accent-gold);
    }

    /* 小功能按钮容器 */
    .smallbutton_box {
      position: fixed;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 8px;
      z-index: 1000;
    }

    /* 小功能按钮 */
    .smallbutton {
      width: 40px;
      height: 40px;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-secondary);
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .smallbutton:hover {
      background: var(--bg-card-hover);
      border-color: var(--accent-gold);
      color: var(--accent-gold);
      transform: scale(1.05);
    }

    /* 内容列表 */
    #game_list {
      position: relative;
      z-index: 1;
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 16px;
      min-height: 400px;
    }

    #game_list.danlie {
      grid-template-columns: 1fr;
      max-width: 800px;
    }

    /* 加载动画 */
    .loading_box {
      grid-column: 1 / -1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 60px;
    }

    .loading {
      font-size: 16px;
      color: var(--text-muted);
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 1; }
    }

    .error {
      color: #e74c3c;
    }

    /* 卡片样式 */
    .game_card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      overflow: hidden;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
    }

    .game_card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--card-accent, var(--accent-gold)), transparent);
    }

    .game_card:hover {
      transform: translateY(-4px);
      border-color: var(--accent-gold);
      box-shadow: 0 8px 24px rgba(0,0,0,0.4);
    }

    .card_header {
      display: flex;
      align-items: center;
      padding: 16px;
      border-bottom: 1px solid var(--border-color);
      gap: 12px;
    }

    .card_icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, #3a3a3a, #2a2a2a);
      border: 2px solid var(--card-accent, var(--accent-gold));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      position: relative;
    }

    .card_icon::after {
      content: '';
      position: absolute;
      inset: -4px;
      border-radius: 50%;
      border: 1px solid var(--card-accent, var(--accent-gold));
      opacity: 0.3;
      animation: iconPulse 2s ease-in-out infinite;
    }

    @keyframes iconPulse {
      0%, 100% { transform: scale(1); opacity: 0.3; }
      50% { transform: scale(1.1); opacity: 0.5; }
    }

    .card_icon svg {
      width: 24px;
      height: 24px;
      color: var(--card-accent, var(--accent-gold));
    }

    .card_title_area {
      flex: 1;
      min-width: 0;
    }

    .card_name {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 2px;
    }

    .card_code {
      font-size: 12px;
      color: var(--card-accent, var(--accent-gold));
      font-family: monospace;
    }

    .card_body {
      padding: 16px;
    }

    .card_description {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.6;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .changelog_content {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.8;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .card_row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 0;
      border-bottom: 1px dashed rgba(255,255,255,0.05);
    }

    .card_row:last-child {
      border-bottom: none;
    }

    .card_label {
      font-size: 13px;
      color: var(--text-muted);
    }

    .card_value {
      font-size: 13px;
      color: var(--text-secondary);
      text-align: right;
      max-width: 60%;
    }

    .card_footer {
      padding: 12px 16px;
      background: rgba(0,0,0,0.2);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .card_theme {
      font-size: 12px;
      padding: 4px 10px;
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      color: var(--text-muted);
    }

    .card_durability {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .durability_bar {
      width: 60px;
      height: 6px;
      background: rgba(255,255,255,0.1);
      border-radius: 3px;
      overflow: hidden;
    }

    .durability_fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent-green), #6bc98e);
      border-radius: 3px;
      transition: width 1s ease;
    }

    .durability_text {
      font-size: 12px;
      color: var(--text-muted);
    }

    /* 解析弹窗 */
    .analysis_box {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
    }

    .analysis_box.show {
      display: flex;
    }

    #analysis_bg {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.8);
    }

    #close_tip {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      color: var(--text-muted);
      font-size: 13px;
    }

    #analysis_info {
      position: relative;
      background: var(--bg-card);
      border: 1px solid var(--accent-gold);
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.6);
    }

    .analysis_header {
      padding: 20px;
      border-bottom: 1px solid var(--border-color);
      position: sticky;
      top: 0;
      background: var(--bg-card);
    }

    .analysis_title {
      font-size: 20px;
      font-weight: 600;
      color: var(--accent-gold-light);
      text-align: center;
    }

    .analysis_content {
      padding: 20px;
    }

    .analysis_row {
      display: flex;
      padding: 10px 0;
      border-bottom: 1px solid var(--border-color);
    }

    .analysis_row:last-child {
      border-bottom: none;
    }

    .analysis_label {
      width: 80px;
      flex-shrink: 0;
      color: var(--text-muted);
      font-size: 14px;
    }

    .analysis_value {
      flex: 1;
      color: var(--text-secondary);
      font-size: 14px;
    }

    .shuoming {
      margin-top: 16px;
      padding: 16px;
      background: rgba(0,0,0,0.2);
      border-radius: 6px;
    }

    .shuoming_title {
      font-size: 14px;
      color: var(--accent-gold);
      margin-bottom: 8px;
    }

    .shuoming_content {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.8;
    }

    /* 页脚 */
    #foot {
      position: relative;
      z-index: 1;
      text-align: center;
      padding: 30px 20px;
      color: var(--text-muted);
      font-size: 12px;
      border-top: 1px solid var(--border-color);
      background: var(--bg-dark);
    }

    #foot a {
      color: var(--accent-gold);
      text-decoration: none;
    }

    /* 入场动画 */
    .fade-in {
      opacity: 0;
      transform: translateY(20px);
      animation: fadeIn 0.5s ease forwards;
    }

    @keyframes fadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* 响应式 */
    @media (max-width: 768px) {
      .page_title {
        font-size: 22px;
        letter-spacing: 2px;
      }

      .navigation_box {
        gap: 6px;
      }

      .navigation_button {
        padding: 6px 12px;
        font-size: 12px;
      }

      .screen_box {
        gap: 8px;
      }

      #game_list {
        grid-template-columns: 1fr;
        padding: 12px;
      }

      .smallbutton {
        width: 36px;
        height: 36px;
        font-size: 14px;
      }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* 滚动条 */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-dark);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--accent-gold);
    }
  </style>
</head>
<body>
  <div id="toptitle">
    <label class="page_title">更多物品介绍页</label>
    <div id="searchbox_waikuang">
      <input type="search" placeholder="请输入您要搜索的关键字" id="searchbox">
    </div>
    <div class="navigation_box">
      <label class="navigation_button xuanzhong" data-tab="item">道具介绍</label>
      <label class="navigation_button" data-tab="explain">模组说明</label>
      <label class="navigation_button" data-tab="qa">常见问题</label>
      <label class="navigation_button" data-tab="update">更新日志</label>
      <label class="navigation_button" data-tab="author">作者留言</label>
    </div>
    <div class="smallbutton_box">
      <div id="changescreen" class="smallbutton" title="改变布局">
        <span class="duolie">☷</span>
      </div>
      <div id="morebutton" class="smallbutton" title="更多模组">…</div>
      <div id="rewardbutton" class="smallbutton" title="打赏作者">￥</div>
    </div>
  </div>

  <div id="game_list">
    <div class="loading_box">
      <div class="loading">页面加载中...</div>
    </div>
  </div>

  <!-- 解析弹窗 -->
  <div class="analysis_box" id="analysisBox">
    <div id="analysis_bg"></div>
    <div id="close_tip">点击任意空白区域关闭</div>
    <div id="analysis_info">
      <div class="analysis_header">
        <div class="analysis_title" id="analysisTitle">勋章详情</div>
      </div>
      <div class="analysis_content" id="analysisContent"></div>
    </div>
  </div>

  <div id="foot">
    <!-- 页脚 -->
  </div>

  <script>
    // 数据加载状态
    let appData = {
      themes: null,
      colors: null,
      items: null,
      updates: null,
      qa: null,
      authorMessage: null,
      modExplain: null
    };

    // 显示加载状态
    function showLoading() {
      const gameListEl = document.getElementById('game_list');
      if (gameListEl) {
        gameListEl.innerHTML = '<div class="loading_box"><div class="loading">数据加载中...</div></div>';
      }
    }

    // 显示错误状态
    function showError(message) {
      const gameListEl = document.getElementById('game_list');
      if (gameListEl) {
        gameListEl.innerHTML = `<div class="loading_box"><div class="error">加载失败: ${message}</div></div>`;
      }
    }

    // 加载所有 JSON 数据
    async function loadAllData() {
      showLoading();
      console.log('开始加载数据...');

      try {
        console.log('正在获取 JSON 文件...');

        const [config, items, updates, qa] = await Promise.all([
          fetch('data/config.json').then(r => { console.log('config.json 响应:', r.status); if (!r.ok) throw new Error('加载配置失败'); return r.json(); }),
          fetch('data/items.json').then(r => { console.log('items.json 响应:', r.status); if (!r.ok) throw new Error('加载物品数据失败'); return r.json(); }),
          fetch('data/updates.json').then(r => { console.log('updates.json 响应:', r.status); if (!r.ok) throw new Error('加载更新日志失败'); return r.json(); }),
          fetch('data/qa.json').then(r => { console.log('qa.json 响应:', r.status); if (!r.ok) throw new Error('加载常见问题失败'); return r.json(); })
        ]);

        console.log('所有数据加载完成:', { config, items, updates, qa });

        appData.themes = config.themes;
        appData.colors = config.colors;
        appData.items = items.items;
        appData.updates = updates.updates;
        appData.qa = qa.qa;
        appData.authorMessage = config.authorMessage;
        appData.modExplain = config.modExplain;

        console.log('appData 已填充:', appData);

        // 数据加载完成后初始化页面
        console.log('开始初始化页面...');
        init();
      } catch (error) {
        console.error('数据加载错误:', error);
        showError(error.message);
      }
    }

    // DOM元素引用
    let gameListEl = null;
    let analysisBoxEl = null;
    let analysisTitleEl = null;
    let analysisContentEl = null;
    let searchboxEl = null;
    let gameThemeEl = null;
    let gameStyleEl = null;
    let gameLevelEl = null;

    // 当前状态
    let currentTab = 'item';
    let currentTheme = '';
    let currentStyle = 0;
    let isDanlie = true;

    // 初始化主题选项
    function initThemeOptions() {
      if (!gameThemeEl || !appData.themes) return;
      let htmlstr = '';
      for (let i = 0; i < appData.themes.length; i++) {
        htmlstr += "<option value='" + appData.themes[i].value + "'>" + appData.themes[i].name + "</option>";
      }
      gameThemeEl.innerHTML = '<option value="">全部</option>' + htmlstr;
    }

    // 初始化颜色风格选项
    function initStyleOptions() {
      if (!gameStyleEl || !appData.colors) return;
      let htmlstr = '';
      for (let i = 0; i < appData.colors.length; i++) {
        htmlstr += "<option value='" + i + "'>" + appData.colors[i].name + "</option>";
      }
      gameStyleEl.innerHTML = htmlstr;
    }

    // 获取图标SVG
    function getIconSvg(theme) {
      const icons = {
        bag: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2v20h12V6h-4V2H6z"/><path d="M10 2v4"/><path d="M14 9v8"/><path d="M10 9v8"/></svg>',
        weapon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.5 17.5L3 6V3h3l11.5 11.5"/><path d="M13 19l6-6"/><path d="M16 16l4 4"/><path d="M19 21l2-2"/></svg>',
        building: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>',
        equipment: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>',
        food: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg>',
        tool: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>',
        other: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>'
      };
      return icons[theme] || icons.other;
    }

    // 渲染勋章卡片
    function renderMedalCards() {
      if (!gameListEl || !appData.items) return;

      let filteredData = appData.items;

      // 筛选主题
      if (currentTheme) {
        filteredData = filteredData.filter(m => m.theme === currentTheme);
      }

      // 筛选风格（根据颜色）
      if (currentStyle !== null && appData.colors[currentStyle]) {
        // 这里可以添加风格筛选逻辑
      }

      let htmlstr = '';

      if (filteredData.length === 0) {
        htmlstr = '<div class="loading_box"><div class="loading">暂无数据</div></div>';
      } else {
        filteredData.forEach((medal, index) => {
          const color = appData.colors[medal.colorIndex] ? appData.colors[medal.colorIndex].color : '#c9a227';
          const delay = index * 0.05;

          htmlstr += `
            <div class="game_card fade-in" style="--card-accent: ${color}; animation-delay: ${delay}s" data-id="${medal.id}">
              <div class="card_header">
                <div class="card_icon" style="--card-accent: ${color}">
                  ${getIconSvg(medal.theme)}
                </div>
                <div class="card_title_area">
                  <div class="card_name">${medal.name}</div>
                  <div class="card_code">${medal.code}</div>
                </div>
              </div>
              <div class="card_body">
                <div class="card_description">${medal.description}</div>
              </div>
              <div class="card_footer">
                <span class="card_theme">${medal.themeName}</span>
              </div>
            </div>
          `;
        });
      }

      gameListEl.innerHTML = htmlstr;

      // 添加卡片点击事件
      document.querySelectorAll('.game_card').forEach(card => {
        card.addEventListener('click', () => {
          const id = parseInt(card.dataset.id);
          showMedalDetail(id);
        });
      });
    }

    // 显示物品详情
    function showMedalDetail(id) {
      const item = appData.items.find(m => m.id === id);
      if (!item || !analysisTitleEl || !analysisContentEl || !analysisBoxEl) return;

      const color = appData.colors[item.colorIndex] ? appData.colors[item.colorIndex].color : '#c9a227';

      analysisTitleEl.textContent = item.name;
      analysisTitleEl.style.color = color;

      let featuresHtml = '';
      if (item.features && item.features.length > 0) {
        featuresHtml = item.features.map(f => `<li>${f}</li>`).join('');
      }

      analysisContentEl.innerHTML = `
        <div class="analysis_row">
          <span class="analysis_label">代码</span>
          <span class="analysis_value" style="color: ${color}">${item.code}</span>
        </div>
        ${featuresHtml ? `
        <div class="shuoming">
          <div class="shuoming_title">特性</div>
          <ul class="shuoming_content" style="margin: 0; padding-left: 20px;">${featuresHtml}</ul>
        </div>
        ` : ''}
        <div class="shuoming">
          <div class="shuoming_title">详细说明</div>
          <div class="shuoming_content">${item.description}</div>
        </div>
      `;

      analysisBoxEl.classList.add('show');
    }

    // 渲染更新日志
    function renderUpdateLog() {
      if (!gameListEl || !appData.updates) return;

      let htmlstr = '';
      appData.updates.forEach((log, index) => {
        const delay = index * 0.05;
        htmlstr += `
          <div class="game_card fade-in" style="animation-delay: ${delay}s">
            <div class="card_body">
              <div class="card_row">
                <span class="card_label">版本</span>
                <span class="card_value" style="color: var(--accent-gold)">${log.version}</span>
              </div>
              <div class="card_row">
                <span class="card_label">日期</span>
                <span class="card_value">${log.date}</span>
              </div>
              <div class="card_row">
                <span class="card_value" style="max-width: 100%; text-align: left;">${log.content}</span>
              </div>
            </div>
          </div>
        `;
      });

      gameListEl.innerHTML = htmlstr;
    }

    // 渲染常见问题
    function renderQA() {
      if (!gameListEl || !appData.qa) return;

      let htmlstr = '';
      appData.qa.forEach((qa, index) => {
        const delay = index * 0.1;
        htmlstr += `
          <div class="game_card fade-in" style="animation-delay: ${delay}s">
            <div class="card_body">
              <div style="font-weight: 600; color: var(--accent-gold); margin-bottom: 8px;">Q: ${qa.q}</div>
              <div style="color: var(--text-secondary); font-size: 14px;">A: ${qa.a}</div>
            </div>
          </div>
        `;
      });

      gameListEl.innerHTML = htmlstr;
    }

    // 渲染作者留言
    function renderAuthor() {
      if (!gameListEl || !appData.authorMessage) return;

      gameListEl.innerHTML = `
        <div class="loading_box">
          <div style="max-width: 600px; text-align: center; padding: 40px;">
            <div style="font-size: 20px; color: var(--accent-gold); margin-bottom: 20px;">作者留言</div>
            <div style="font-size: 15px; color: var(--text-secondary); line-height: 2;">${appData.authorMessage}</div>
          </div>
        </div>
      `;
    }

    // 渲染模组说明
    function renderExplain() {
      if (!gameListEl || !appData.modExplain) return;

      gameListEl.innerHTML = `
        <div class="loading_box">
          <div style="max-width: 600px; text-align: center; padding: 40px;">
            <div style="font-size: 20px; color: var(--accent-gold); margin-bottom: 20px;">模组说明</div>
            <div style="font-size: 15px; color: var(--text-secondary); line-height: 2;">${appData.modExplain}</div>
          </div>
        </div>
      `;
    }

    // 切换标签
    function switchTab(tab) {
      currentTab = tab;
      
      // 更新导航按钮状态
      document.querySelectorAll('.navigation_button').forEach(btn => {
        btn.classList.remove('xuanzhong');
        if (btn.dataset.tab === tab) {
          btn.classList.add('xuanzhong');
        }
      });
      
      // 根据标签渲染不同内容
      switch (tab) {
        case 'item':
          renderMedalCards();
          break;
        case 'explain':
          renderExplain();
          break;
        case 'qa':
          renderQA();
          break;
        case 'update':
          renderUpdateLog();
          break;
        case 'author':
          renderAuthor();
          break;
      }
    }

    // 搜索功能
    function handleSearch(keyword) {
      if (currentTab !== 'item') return;
      
      const cards = document.querySelectorAll('.game_card');
      const lowerKeyword = keyword.toLowerCase();
      
      cards.forEach(card => {
        const name = card.querySelector('.card_name').textContent.toLowerCase();
        const code = card.querySelector('.card_code').textContent.toLowerCase();
        
        if (name.includes(lowerKeyword) || code.includes(lowerKeyword)) {
          card.style.display = '';
        } else {
          card.style.display = 'none';
        }
      });
    }

    // 切换布局
    function toggleLayout() {
      if (!gameListEl) return;
      isDanlie = !isDanlie;
      if (isDanlie) {
        gameListEl.classList.add('danlie');
      } else {
        gameListEl.classList.remove('danlie');
      }
    }

    // 关闭弹窗
    function closeAnalysis() {
      if (analysisBoxEl) {
        analysisBoxEl.classList.remove('show');
      }
    }

    // 初始化事件监听
    function initEventListeners() {
      // 导航标签点击
      document.querySelectorAll('.navigation_button').forEach(btn => {
        btn.addEventListener('click', () => {
          switchTab(btn.dataset.tab);
        });
      });
      
      // 搜索框输入
      if (searchboxEl) {
        searchboxEl.addEventListener('input', (e) => {
          handleSearch(e.target.value);
        });
      }
      
      // 主题筛选
      if (gameThemeEl) {
        gameThemeEl.addEventListener('change', (e) => {
          currentTheme = e.target.value;
          if (currentTab === 'item') {
            renderMedalCards();
          }
        });
      }
      
      // 风格筛选
      if (gameStyleEl) {
        gameStyleEl.addEventListener('change', (e) => {
          currentStyle = parseInt(e.target.value);
          if (currentTab === 'item') {
            renderMedalCards();
          }
        });
      }
      
      // 布局切换按钮
      const changescreenBtn = document.getElementById('changescreen');
      if (changescreenBtn) {
        changescreenBtn.addEventListener('click', toggleLayout);
      }
      
      // 弹窗关闭
      if (analysisBoxEl) {
        const analysisBg = document.getElementById('analysis_bg');
        if (analysisBg) {
          analysisBg.addEventListener('click', closeAnalysis);
        }
      }
      
      // 帮助按钮
      const helpBtn = document.getElementById('helpbutton');
      if (helpBtn) {
        helpBtn.addEventListener('click', () => {
          alert('这是一个能力勋章介绍页面，您可以：\n1. 点击勋章卡片查看详情\n2. 使用搜索框搜索勋章\n3. 使用筛选器按主题筛选\n4. 点击右上角按钮切换布局');
        });
      }
    }

    // 页面初始化
    function init() {
      // 获取DOM元素引用
      gameListEl = document.getElementById('game_list');
      analysisBoxEl = document.getElementById('analysisBox');
      analysisTitleEl = document.getElementById('analysisTitle');
      analysisContentEl = document.getElementById('analysisContent');
      searchboxEl = document.getElementById('searchbox');
      gameThemeEl = document.getElementById('game_theme');
      gameStyleEl = document.getElementById('game_style');
      gameLevelEl = document.getElementById('game_level');
      
      // 初始化选项
      initThemeOptions();
      initStyleOptions();
      
      // 初始化事件
      initEventListeners();
      
      // 渲染初始内容
      renderMedalCards();

      // 应用默认布局
      if (isDanlie) {
        gameListEl.classList.add('danlie');
      }
    }

    // DOM加载完成后加载数据
    document.addEventListener('DOMContentLoaded', loadAllData);
  </script>
</body>
</html>